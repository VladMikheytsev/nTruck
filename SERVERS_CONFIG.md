# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤ NTruck

## üöÄ –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Frontend (Vite)
- **–ü–æ—Ä—Ç**: 3001
- **URL**: http://localhost:3001
- **–ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞**: `npm run dev`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–ø—É—â–µ–Ω

### GPS Proxy Server (Trak-4 API)
- **–ü–æ—Ä—Ç**: 3002
- **URL**: http://localhost:3002
- **–ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞**: `node proxy-server.cjs`
- **Health Check**: http://localhost:3002/health
- **API Endpoint**: http://localhost:3002/api/trak4/device
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–ø—É—â–µ–Ω

## üìã Endpoints

### Proxy Server Endpoints:
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
- `POST /api/trak4/device` - –ü—Ä–æ–∫—Å–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è GPS –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∫ Trak-4 API:
```bash
curl -X POST http://localhost:3002/api/trak4/device \
  -H "Content-Type: application/json" \
  -d '{
    "APIKey": "your-api-key",
    "DeviceID": 123456
  }'
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤:

**Frontend (vite.config.ts):**
```typescript
export default defineConfig({
  server: {
    port: 3001, // –ò–∑–º–µ–Ω–∏—Ç—å –∑–¥–µ—Å—å
  },
})
```

**Proxy Server (proxy-server.cjs):**
```javascript
const PORT = 3002; // –ò–∑–º–µ–Ω–∏—Ç—å –∑–¥–µ—Å—å
```

**Frontend Services (src/services/):**
```typescript
// gpsTrackingService.ts
private static readonly PROXY_BASE_URL = 'http://localhost:3002/api/trak4';

// trak4GPSService.ts
private static readonly PROXY_URL = 'http://localhost:3002/api/trak4/device';

// trackingDiagnostics.ts
// –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ localhost:3002
```

## üö¶ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤

### 1. –ó–∞–ø—É—Å–∫ Frontend:
```bash
npm run dev
```

### 2. –ó–∞–ø—É—Å–∫ GPS Proxy Server:
```bash
node proxy-server.cjs
```

### 3. –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ:
```bash
# Frontend
npm run dev &

# Proxy Server
node proxy-server.cjs &
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### Frontend:
```bash
curl http://localhost:3001
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å HTML —Å—Ç—Ä–∞–Ω–∏—Ü—É
```

### Proxy Server:
```bash
curl http://localhost:3002/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"status":"OK",...}
```

### GPS API:
```bash
curl -X POST http://localhost:3002/api/trak4/device \
  -H "Content-Type: application/json" \
  -d '{"APIKey":"your-key","DeviceID":123456}'
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å GPS –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –æ—à–∏–±–∫—É API
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–Ω—è—Ç—ã–µ –ø–æ—Ä—Ç—ã
lsof -i :3001
lsof -i :3002

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 <PID>
```

### Proxy Server –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Node.js —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `node --version`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: `npm install`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 3002 —Å–≤–æ–±–æ–¥–µ–Ω

### Frontend –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Vite –∑–∞–ø—É—â–µ–Ω: `ps aux | grep vite`
2. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à: `rm -rf node_modules/.vite`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä: `npm run dev`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:
```bash
ps aux | grep node
```

### –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä—Ç—ã:
```bash
lsof -i :3001 -i :3002
```

### –õ–æ–≥–∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞:
–°–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `node proxy-server.cjs`

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: 
- –ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- API –∫–ª—é—á–∏ Trak-4 –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ
- CORS –≤–∫–ª—é—á–µ–Ω –¥–ª—è –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- Frontend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç, –µ—Å–ª–∏ 3000 –∑–∞–Ω—è—Ç
- Proxy Server –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç 3002
- –í—Å–µ GPS –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ CORS
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ GPS –¥–∞–Ω–Ω—ã—Ö: 5 –º–∏–Ω—É—Ç
- Rate limit fallback: 1 –º–∏–Ω—É—Ç–∞

## üéØ –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ Node –ø—Ä–æ—Ü–µ—Å—Å—ã
pkill node

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–∞ —Å–µ—Ä–≤–µ—Ä–∞
npm run dev & node proxy-server.cjs &

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–±–æ–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
curl http://localhost:3001 && curl http://localhost:3002/health

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä
pkill -f proxy-server.cjs
```

